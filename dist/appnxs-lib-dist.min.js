var _get=function e(E,t,r){var i=Object.getOwnPropertyDescriptor(E,t);if(void 0===i){var n=Object.getPrototypeOf(E);return null===n?void 0:e(n,t,r)}if("value"in i)return i.value;var o=i.get;return void 0===o?void 0:o.call(r)},_inherits=function(e,E){if("function"!=typeof E&&null!==E)throw new TypeError("Super expression must either be null or a function, not "+typeof E);e.prototype=Object.create(E&&E.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),E&&(e.__proto__=E)},_classCallCheck=function(e,E){if(!(e instanceof E))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,E){for(var t=0;t<E.length;t++){var r=E[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(E,t,r){return t&&e(E.prototype,t),r&&e(E,r),E}}();!function(e,E){"object"==typeof exports&&"undefined"!=typeof module?E(exports,require("limiter"),require("request-promise")):"function"==typeof define&&define.amd?define(["exports","limiter","request-promise"],E):E(e["null"]={},e._limiter,e.request_promise)}(this,function(e,E,t){"use strict";function r(e){return"OK"!==e.response.status?!0:!1}function i(e){var E=new Error(e&&e.response&&e.response.error);return E.error_id=e&&e.response&&e.response.error_id,E}function n(e){var E=i(e);return E}var o={ACCOUNT_RECOVERY_SERVICE:"/account-recovery",AD_PROFILE_SERVICE:"/ad-profile",AD_QUALITY_RULE_SERVICE:"/ad-quality-rule",AD_SERVER_SERVICE:"/ad-server",ADVERTISER_SERVICE:"/advertiser",APP_INSTALLATION_SERVICE:"/app-installation",AUTHENTICATION_SERVICE:"/auth",BATCH_SEGMENT_SERVICE:"/batch-segment",BRAND_COMPANY_SERVICE:"/brand-company",BRAND_SERVICE:"/brand",BROKER_SERVICE:"/broker",BROWSER_SERVICE:"/browser",CAMPAIGN_SERVICE:"/campaign",CARRIER_SERVICE:"/carrier",CATEGORY_SERVICE:"/category",CITY_SERVICE:"/city",CLICK_TRACKER_SERVICE:"/clicktracker",CONTENT_CATEGORY_SERVICE:"/content-category",COUNTRY_SERVICE:"/country",CREATIVE_CUSTOM_REQUEST_TEMPLATE_SERVICE:"/creative-custom-request-template",CREATIVE_CUSTOM_REQUEST_TEMPLATE_TYPE_SERVICE:"/creative-custom-request-template-type",CREATIVE_FOLDER_SERVICE:"/creative-folder",CREATIVE_FORMAT_SERVICE:"/creative-format",CREATIVE_MACRO_CHECK_SERVICE:"/creative-macro-check",CREATIVE_SEARCH_SERVICE:"/creative-search",CREATIVE_SERVICE:"/creative",CREATIVE_TEMPLATE_SERVICE:"/template",CURRENCY_SERVICE:"/currency",DEAL_BUYER_ACCESS_SERVICE:"/package-buyer-access",DEAL_FROM_PACKAGE_SERVICE:"/deal-from-package",DEAL_SERVICE:"/deal",DEMOGRAPHIC_AREA_SERVICE:"/dma",DEVELOPER_SERVICE:"/developer",DEVICE_MAKE_SERVICE:"/device-make",DEVICE_MODEL_SERVICE:"/device-model",DOMAIN_AUDIT_STATUS_SERVICE:"/url-audit-search",DOMAIN_LIST_SERVICE:"/domain-list",EXTERNAL_INVENTORY_CODE_SERVICE:"/external-inv-code",EXTRACT_CLICKTAGS_SERVICE:"/extract-click-tags",FEED_STATUS_SERVICE:"/feed-status",IMPRESSION_TRACKER_SERVICE:"/imptracker",INSERTION_ORDER_SERVICE:"/insertion-order",INVENTORY_ATTRIBUTE_SERVICE:"/inventory-attribute",INVENTORY_GROUP_SERVICE:"/inventory-group",INVENTORY_RESOLD_SERVICE:"/inventory-resold",INVENTORY_SOURCE_SERVICE:"/inventory-source",IP_RANGE_LIST_SERVICE:"/ip-range-list",LABEL_SERVICE:"/label",LANGUAGE_SERVICE:"/language",LINE_ITEM_SERVICE:"/line-item",LOG_LEVEL_DATA_SERVICE:"/siphon",LOOKUP_SERVICE:"/lookup",MANUAL_OFFER_RANKING_SERVICE:"/manual-offer-ranking",MEDIA_SUBTYPE_SERVICE:"/media-subtype",MEDIA_TYPE_SERVICE:"/media-type",MEMBER_PROFILE_SERVICE:"/member-profile",MEMBER_SERVICE:"/member",MOBILE_APP_INSTANCE_LIST_SERVICE:"/mobile-app-instance-list",MOBILE_APP_INSTANCE_SERVICE:"/mobile-app-instance",MOBILE_APP_SERVICE:"/mobile-app",MOBILE_APP_STORE_SERVICE:"/mobile-app-store",OBJECT_LIMIT_SERVICE:"/object-limit",OPERATING_SYSTEM_EXTENDED_SERVICE:"/operating-system-extended",OPERATING_SYSTEM_FAMILY_SERVICE:"/operating-system-family",OPERATING_SYSTEM_SERVICE:"/operating-system",OPTIMIZATION_ZONE_SERVICE:"/optimization-zone",PACKAGE_BUYER_ACCESS_SERVICE:"/package-buyer-access",PACKAGE_SERVICE:"/package",PAYMENT_RULE_SERVICE:"/payment-rule",PIXEL_SERVICE:"/pixel",PIXEL_TEMPLATE_SERVICE:"/pixel-template",PLACEMENT_SERVICE:"/placement",PLATFORM_MEMBER_SERVICE:"/platform-member",PLUGIN_INSTANCE_SERVICE:"/plugin-instance",PLUGIN_SERVICE:"/plugin",PROFILE_SERVICE:"/profile",PROFILE_SUMMARY_SERVICE:"/profile-summary",PUBLISHER_SERVICE:"/publisher",REGION_SERVICE:"/region",REPORT_SERVICE:"/report",REPORT_STATUS_SERVICE:"/report-status",SAVED_REPORT_SERVICE:"/saved-report",SEARCH_SERVICE:"/search",SEGMENT_SERVICE:"/segment",SIPHON_CONFIG_SERVICE:"/siphon-config",SITE_SERVICE:"/site",TAG_PARSER_SERVICE:"/tag-parser-job",TECHNICAL_ATTRIBUTE_SERVICE:"/technical-attribute",THIRD_PARTY_PAGE_ACCESS_SERVICE:"/thirdparty-pageaccess",THIRD_PARTY_PIXEL_SERVICE:"/thirdparty-pixel",TOWN_SERVICE:"/town",USER_GROUP_PATTERN_SERVICE:"/usergroup-pattern",USER_SERVICE:"/user",USER_VERIFICATION_SERVICE:"/user-verification",VISIBILITY_PROFILE_SERVICE:"/visibility-profile"},a=o;e.endpoints=a;var _=function(){function e(){var E=void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,e),this.options=E,this.options.apiBase=this.options.apiBase||"/"}return _createClass(e,[{key:"get",value:function(e){var E=void 0===arguments[1]?{}:arguments[1];return this.request("GET",e,E)}},{key:"put",value:function(e){var E=void 0===arguments[1]?{}:arguments[1];return this.request("PUT",e,E)}},{key:"post",value:function(e){var E=void 0===arguments[1]?{}:arguments[1];return this.request("POST",e,E)}},{key:"request",value:function(e,E,i){var o={uri:this.options.apiBase+E,json:i,method:e};return this.options.token&&(o.headers={Authorization:this.options.token}),t(o).then(function(e){if(r(e))throw n(e);return e.response})}}]),e}(),R=_;e.Transport=R;var s=3e5,I=6e4,C=6e4,u=100,S=60,p=10,c=36e5,T={},V=function(e){function t(){var e=void 0===arguments[0]?"http://api.appnexus.com":arguments[0],r=void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.options={apiBase:e,limits:r},this.writeLimiter=new E.RateLimiter(r.write||S,C),this.readLimiter=new E.RateLimiter(r.read||u,I),this.authLimiter=new E.RateLimiter(r.auth||p,s)}return _inherits(t,e),_createClass(t,[{key:"authorize",value:function(e,E){var t=this;if(!e||!E)throw Error("Authorization credentials are missing!");T={username:e,password:E};var r={auth:T};return this.options.token&&delete this.options.token,this.post(a.AUTHENTICATION_SERVICE,r).then(function(e){return t.options.token={value:e.token,_ts:+new Date},e.token})}},{key:"refreshToken",value:function(){if(!T.username||!T.password)throw Error("Authorization credentials are missing!");return this.authorize(T.username,T.password)}},{key:"isExpired",value:function(){return!!(this.options.token&&this.options.token._ts+c>=+new Date)}},{key:"rateLimiter",value:function(e,E){var t=this;return new Promise(function(r,i){var n=null;if(E===a.AUTHENTICATION_SERVICE)n=t.authLimiter;else if("POST"===e||"PUT"===e||"DELETE"===e)n=t.writeLimiter;else{if("GET"!==e)return r();n=t.readLimiter}n.removeTokens(1,function(e,E){return e?i(e):void r(E)})})}},{key:"request",value:function(){for(var e=this,E=arguments.length,r=Array(E),i=0;E>i;i++)r[i]=arguments[i];var n=this,o=r[0],_=r[1];return this.rateLimiter(o,_).then(function(){return _!==a.AUTHENTICATION_SERVICE&&e.isExpired()?e.refreshToken().then(_get(Object.getPrototypeOf(t.prototype),"request",n).apply(n,r)):_get(Object.getPrototypeOf(t.prototype),"request",n).apply(n,r)})}}]),t}(R),l=V;e.Client=l});
//# sourceMappingURL=appnxs-lib-dist.min.js.map
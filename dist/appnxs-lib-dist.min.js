var _get=function e(t,E,r){var i=Object.getOwnPropertyDescriptor(t,E);if(void 0===i){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,E,r)}if("value"in i)return i.value;var o=i.get;return void 0===o?void 0:o.call(r)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var E=0;E<t.length;E++){var r=t[E];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,E,r){return E&&e(t.prototype,E),r&&e(t,r),t}}();!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("limiter"),require("request-promise")):"function"==typeof define&&define.amd?define(["exports","limiter","request-promise"],t):t(e["null"]={},e._limiter,e.request_promise)}(this,function(e,t,E){"use strict";function r(e){return"OK"!==e.response.status?!0:!1}function i(e){var t=new Error(e&&e.response&&e.response.error);return t.error_id=e&&e.response&&e.response.error_id,t}function n(e){var t=i(e);return t}var o={ACCOUNT_RECOVERY_SERVICE:"/account-recovery",AD_PROFILE_SERVICE:"/ad-profile",AD_QUALITY_RULE_SERVICE:"/ad-quality-rule",AD_SERVER_SERVICE:"/ad-server",ADVERTISER_SERVICE:"/advertiser",APP_INSTALLATION_SERVICE:"/app-installation",AUTHENTICATION_SERVICE:"/auth",BATCH_SEGMENT_SERVICE:"/batch-segment",BRAND_COMPANY_SERVICE:"/brand-company",BRAND_SERVICE:"/brand",BROKER_SERVICE:"/broker",BROWSER_SERVICE:"/browser",CAMPAIGN_SERVICE:"/campaign",CARRIER_SERVICE:"/carrier",CATEGORY_SERVICE:"/category",CITY_SERVICE:"/city",CLICK_TRACKER_SERVICE:"/clicktracker",CONTENT_CATEGORY_SERVICE:"/content-category",COUNTRY_SERVICE:"/country",CREATIVE_CUSTOM_REQUEST_TEMPLATE_SERVICE:"/creative-custom-request-template",CREATIVE_CUSTOM_REQUEST_TEMPLATE_TYPE_SERVICE:"/creative-custom-request-template-type",CREATIVE_FOLDER_SERVICE:"/creative-folder",CREATIVE_FORMAT_SERVICE:"/creative-format",CREATIVE_MACRO_CHECK_SERVICE:"/creative-macro-check",CREATIVE_SEARCH_SERVICE:"/creative-search",CREATIVE_SERVICE:"/creative",CREATIVE_TEMPLATE_SERVICE:"/template",CURRENCY_SERVICE:"/currency",DEAL_BUYER_ACCESS_SERVICE:"/package-buyer-access",DEAL_FROM_PACKAGE_SERVICE:"/deal-from-package",DEAL_SERVICE:"/deal",DEMOGRAPHIC_AREA_SERVICE:"/dma",DEVELOPER_SERVICE:"/developer",DEVICE_MAKE_SERVICE:"/device-make",DEVICE_MODEL_SERVICE:"/device-model",DOMAIN_AUDIT_STATUS_SERVICE:"/url-audit-search",DOMAIN_LIST_SERVICE:"/domain-list",EXTERNAL_INVENTORY_CODE_SERVICE:"/external-inv-code",EXTRACT_CLICKTAGS_SERVICE:"/extract-click-tags",FEED_STATUS_SERVICE:"/feed-status",IMPRESSION_TRACKER_SERVICE:"/imptracker",INSERTION_ORDER_SERVICE:"/insertion-order",INVENTORY_ATTRIBUTE_SERVICE:"/inventory-attribute",INVENTORY_GROUP_SERVICE:"/inventory-group",INVENTORY_RESOLD_SERVICE:"/inventory-resold",INVENTORY_SOURCE_SERVICE:"/inventory-source",IP_RANGE_LIST_SERVICE:"/ip-range-list",LABEL_SERVICE:"/label",LANGUAGE_SERVICE:"/language",LINE_ITEM_SERVICE:"/line-item",LOG_LEVEL_DATA_SERVICE:"/siphon",LOOKUP_SERVICE:"/lookup",MANUAL_OFFER_RANKING_SERVICE:"/manual-offer-ranking",MEDIA_SUBTYPE_SERVICE:"/media-subtype",MEDIA_TYPE_SERVICE:"/media-type",MEMBER_PROFILE_SERVICE:"/member-profile",MEMBER_SERVICE:"/member",MOBILE_APP_INSTANCE_LIST_SERVICE:"/mobile-app-instance-list",MOBILE_APP_INSTANCE_SERVICE:"/mobile-app-instance",MOBILE_APP_SERVICE:"/mobile-app",MOBILE_APP_STORE_SERVICE:"/mobile-app-store",OBJECT_LIMIT_SERVICE:"/object-limit",OPERATING_SYSTEM_EXTENDED_SERVICE:"/operating-system-extended",OPERATING_SYSTEM_FAMILY_SERVICE:"/operating-system-family",OPERATING_SYSTEM_SERVICE:"/operating-system",OPTIMIZATION_ZONE_SERVICE:"/optimization-zone",PACKAGE_BUYER_ACCESS_SERVICE:"/package-buyer-access",PACKAGE_SERVICE:"/package",PAYMENT_RULE_SERVICE:"/payment-rule",PIXEL_SERVICE:"/pixel",PIXEL_TEMPLATE_SERVICE:"/pixel-template",PLACEMENT_SERVICE:"/placement",PLATFORM_MEMBER_SERVICE:"/platform-member",PLUGIN_INSTANCE_SERVICE:"/plugin-instance",PLUGIN_SERVICE:"/plugin",PROFILE_SERVICE:"/profile",PROFILE_SUMMARY_SERVICE:"/profile-summary",PUBLISHER_SERVICE:"/publisher",REGION_SERVICE:"/region",REPORT_SERVICE:"/report",REPORT_STATUS_SERVICE:"/report-status",SAVED_REPORT_SERVICE:"/saved-report",SEARCH_SERVICE:"/search",SEGMENT_SERVICE:"/segment",SIPHON_CONFIG_SERVICE:"/siphon-config",SITE_SERVICE:"/site",TAG_PARSER_SERVICE:"/tag-parser-job",TECHNICAL_ATTRIBUTE_SERVICE:"/technical-attribute",THIRD_PARTY_PAGE_ACCESS_SERVICE:"/thirdparty-pageaccess",THIRD_PARTY_PIXEL_SERVICE:"/thirdparty-pixel",TOWN_SERVICE:"/town",USER_GROUP_PATTERN_SERVICE:"/usergroup-pattern",USER_SERVICE:"/user",USER_VERIFICATION_SERVICE:"/user-verification",VISIBILITY_PROFILE_SERVICE:"/visibility-profile"},a=o;e.endpoints=a;var s=function(){function e(){var t=void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,e),this.options=t,this.options.apiBase=this.options.apiBase||"/"}return _createClass(e,[{key:"get",value:function(e){var t=void 0===arguments[1]?{}:arguments[1];return this.request("GET",e,t)}},{key:"put",value:function(e){var t=void 0===arguments[1]?{}:arguments[1];return this.request("PUT",e,t)}},{key:"post",value:function(e){var t=void 0===arguments[1]?{}:arguments[1];return this.request("POST",e,t)}},{key:"delete",value:function(e){var t=void 0===arguments[1]?{}:arguments[1];return this.request("DELETE",e,t)}},{key:"request",value:function(e,t,i){var o={uri:this.options.apiBase+t,method:e};return"GET"===e?(o.json=!0,o.qs=i):o.json=i,this.options.token&&this.options.token.value&&(o.headers={Authorization:this.options.token.value}),E(o).then(function(e){if(r(e))throw n(e);return e.response})}}]),e}(),_=s;e.Transport=_;var R=3e5,I=6e4,u=6e4,C=100,S=60,p=10,T=36e5,c={},V=function(e){function E(){var e=void 0===arguments[0]?"http://api.appnexus.com":arguments[0],r=void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,E),_get(Object.getPrototypeOf(E.prototype),"constructor",this).call(this),this.options={apiBase:e,limits:r},this.writeLimiter=new t.RateLimiter(r.write||S,u),this.readLimiter=new t.RateLimiter(r.read||C,I),this.authLimiter=new t.RateLimiter(r.auth||p,R)}return _inherits(E,e),_createClass(E,[{key:"authorize",value:function(e,t){var E=this;if(!e||!t)throw Error("Authorization credentials are missing!");c={username:e,password:t};var r={auth:c};return this.options.token&&delete this.options.token,this.post(a.AUTHENTICATION_SERVICE,r).then(function(e){return E.options.token={value:e.token,_ts:+new Date},e.token})}},{key:"refreshToken",value:function(){if(!c.username||!c.password)throw Error("Authorization credentials are missing!");return this.authorize(c.username,c.password)}},{key:"isExpired",value:function(){var e=void 0===arguments[0]?0:arguments[0],t=this.options.token&&this.options.token._ts?this.options.token._ts:e;return t+T<=+new Date}},{key:"rateLimiter",value:function(e,t){var E=this;return new Promise(function(r,i){var n=null;if(t===a.AUTHENTICATION_SERVICE)n=E.authLimiter;else if("POST"===e||"PUT"===e||"DELETE"===e)n=E.writeLimiter;else{if("GET"!==e)return r();n=E.readLimiter}n.removeTokens(1,function(e,t){return e?i(e):void r(t)})})}},{key:"request",value:function(){for(var e=this,t=arguments.length,r=Array(t),i=0;t>i;i++)r[i]=arguments[i];var n=this,o=r[0],s=r[1];return this.rateLimiter(o,s).then(function(){return s!==a.AUTHENTICATION_SERVICE&&e.isExpired()?e.refreshToken().then(_get(Object.getPrototypeOf(E.prototype),"request",n).apply(n,r)):_get(Object.getPrototypeOf(E.prototype),"request",n).apply(n,r)})}}]),E}(_),l=V;e.Client=l});
//# sourceMappingURL=appnxs-lib-dist.min.js.map
{"version":3,"file":"appnxs-lib-dist.js","sources":["../src/Endpoints.js","../src/utils/ErrorHandlers.js","../src/Transport.js","../src/Client.js","../src/index.js"],"sourcesContent":["/**\n * Created by Luke on 01/05/15.\n */\n\nconst endpoints = {\n\n  /**\n   * source: https://wiki.appnexus.com/display/api/API+Services\n   */\n\n  ACCOUNT_RECOVERY_SERVICE: '/account-recovery',\n  AD_PROFILE_SERVICE: '/ad-profile',\n  AD_QUALITY_RULE_SERVICE: '/ad-quality-rule',\n  AD_SERVER_SERVICE: '/ad-server',\n  ADVERTISER_SERVICE: '/advertiser',\n  APP_INSTALLATION_SERVICE: '/app-installation',\n  AUTHENTICATION_SERVICE: '/auth',\n  BATCH_SEGMENT_SERVICE: '/batch-segment',\n  BRAND_COMPANY_SERVICE: '/brand-company',\n  BRAND_SERVICE: '/brand',\n  BROKER_SERVICE: '/broker',\n  BROWSER_SERVICE: '/browser',\n  CAMPAIGN_SERVICE: '/campaign',\n  CARRIER_SERVICE: '/carrier',\n  CATEGORY_SERVICE: '/category',\n  CITY_SERVICE: '/city',\n  CLICK_TRACKER_SERVICE: '/clicktracker',\n  CONTENT_CATEGORY_SERVICE: '/content-category',\n  COUNTRY_SERVICE: '/country',\n  CREATIVE_CUSTOM_REQUEST_TEMPLATE_SERVICE: '/creative-custom-request-template',\n  CREATIVE_CUSTOM_REQUEST_TEMPLATE_TYPE_SERVICE: '/creative-custom-request-template-type',\n  CREATIVE_FOLDER_SERVICE: '/creative-folder',\n  CREATIVE_FORMAT_SERVICE: '/creative-format',\n  CREATIVE_MACRO_CHECK_SERVICE: '/creative-macro-check',\n  CREATIVE_SEARCH_SERVICE: '/creative-search',\n  CREATIVE_SERVICE: '/creative',\n  CREATIVE_TEMPLATE_SERVICE: '/template',\n  CURRENCY_SERVICE: '/currency',\n  DEAL_BUYER_ACCESS_SERVICE: '/package-buyer-access',\n  DEAL_FROM_PACKAGE_SERVICE: '/deal-from-package',\n  DEAL_SERVICE: '/deal',\n  DEMOGRAPHIC_AREA_SERVICE: '/dma',\n  DEVELOPER_SERVICE: '/developer',\n  DEVICE_MAKE_SERVICE: '/device-make',\n  DEVICE_MODEL_SERVICE: '/device-model',\n  DOMAIN_AUDIT_STATUS_SERVICE: '/url-audit-search',\n  DOMAIN_LIST_SERVICE: '/domain-list',\n  EXTERNAL_INVENTORY_CODE_SERVICE: '/external-inv-code',\n  EXTRACT_CLICKTAGS_SERVICE: '/extract-click-tags',\n  FEED_STATUS_SERVICE: '/feed-status',\n  IMPRESSION_TRACKER_SERVICE: '/imptracker',\n  INSERTION_ORDER_SERVICE: '/insertion-order',\n  INVENTORY_ATTRIBUTE_SERVICE: '/inventory-attribute',\n  INVENTORY_GROUP_SERVICE: '/inventory-group',\n  INVENTORY_RESOLD_SERVICE: '/inventory-resold',\n  INVENTORY_SOURCE_SERVICE: '/inventory-source',\n  IP_RANGE_LIST_SERVICE: '/ip-range-list',\n  LABEL_SERVICE: '/label',\n  LANGUAGE_SERVICE: '/language',\n  LINE_ITEM_SERVICE: '/line-item',\n  LOG_LEVEL_DATA_SERVICE: '/siphon',\n  LOOKUP_SERVICE: '/lookup',\n  MANUAL_OFFER_RANKING_SERVICE: '/manual-offer-ranking',\n  MEDIA_SUBTYPE_SERVICE: '/media-subtype',\n  MEDIA_TYPE_SERVICE: '/media-type',\n  MEMBER_PROFILE_SERVICE: '/member-profile',\n  MEMBER_SERVICE: '/member',\n  MOBILE_APP_INSTANCE_LIST_SERVICE: '/mobile-app-instance-list',\n  MOBILE_APP_INSTANCE_SERVICE: '/mobile-app-instance',\n  MOBILE_APP_SERVICE: '/mobile-app',\n  MOBILE_APP_STORE_SERVICE: '/mobile-app-store',\n  OBJECT_LIMIT_SERVICE: '/object-limit',\n  OPERATING_SYSTEM_EXTENDED_SERVICE: '/operating-system-extended',\n  OPERATING_SYSTEM_FAMILY_SERVICE: '/operating-system-family',\n  OPERATING_SYSTEM_SERVICE: '/operating-system',\n  OPTIMIZATION_ZONE_SERVICE: '/optimization-zone',\n  PACKAGE_BUYER_ACCESS_SERVICE: '/package-buyer-access',\n  PACKAGE_SERVICE: '/package',\n  PAYMENT_RULE_SERVICE: '/payment-rule',\n  PIXEL_SERVICE: '/pixel',\n  PIXEL_TEMPLATE_SERVICE: '/pixel-template',\n  PLACEMENT_SERVICE: '/placement',\n  PLATFORM_MEMBER_SERVICE: '/platform-member',\n  PLUGIN_INSTANCE_SERVICE: '/plugin-instance',\n  PLUGIN_SERVICE: '/plugin',\n  PROFILE_SERVICE: '/profile',\n  PROFILE_SUMMARY_SERVICE: '/profile-summary',\n  PUBLISHER_SERVICE: '/publisher',\n  REGION_SERVICE: '/region',\n  REPORT_SERVICE: '/report',\n  REPORT_STATUS_SERVICE: '/report-status',\n  SAVED_REPORT_SERVICE: '/saved-report',\n  SEARCH_SERVICE: '/search',\n  SEGMENT_SERVICE: '/segment',\n  SIPHON_CONFIG_SERVICE: '/siphon-config',\n  SITE_SERVICE: '/site',\n  TAG_PARSER_SERVICE: '/tag-parser-job',\n  TECHNICAL_ATTRIBUTE_SERVICE: '/technical-attribute',\n  THIRD_PARTY_PAGE_ACCESS_SERVICE: '/thirdparty-pageaccess',\n  THIRD_PARTY_PIXEL_SERVICE: '/thirdparty-pixel',\n  TOWN_SERVICE: '/town',\n  USER_GROUP_PATTERN_SERVICE: '/usergroup-pattern',\n  USER_SERVICE: '/user',\n  USER_VERIFICATION_SERVICE: '/user-verification',\n  VISIBILITY_PROFILE_SERVICE: '/visibility-profile',\n};\n\nexport default endpoints;\n","/**\n * Created by LukevdPalen on 01/05/15.\n */\n\nexport function responseContainsError(body) {\n  return body === Object(body)\n      && body.response\n        && (!body.response.status\n          || (body.response.status\n          && body.response.status !== 'OK'));\n}\n\nexport function wrapError(error) {\n  return Object.assign(error, {\n    message: `${error.statusCode} - ${error.response.error || error.response.statusMessage}`,\n  });\n}\n\nexport function ErrorResponse(body) {\n  const error = wrapError(body);\n  return error;\n}\n\nexport function clientError(response) {\n  return response.statusCode >= 400 && response.statusCode < 500;\n}\n\nexport class RequestError extends Error {\n  constructor(cause) {\n    super();\n    this.name = 'RequestError';\n    this.message = String(cause);\n    this.cause = cause;\n  }\n}\n\nexport class StatusCodeError extends Error {\n  constructor(statusCode, message) {\n    super();\n    this.name = 'StatusCodeError';\n    this.statusCode = statusCode;\n    this.message = `${statusCode} - ${message}`;\n  }\n}\n","/* eslint class-methods-use-this: off */\n\n/**\n * Created by Luke on 01/05/15.\n */\nimport request from 'request';\n\nimport {\n  RequestError, StatusCodeError, responseContainsError, clientError,\n} from './utils/ErrorHandlers';\n\n/**\n * AppNexus Transport class.\n * @class Transport\n * @classdesc The transport is responsible for handling all\n *            request to the AppNexus api service\n */\nclass Transport {\n  /**\n   * Transport constructor.\n   * @constructs Transport\n   * @params {object} [options={}] - transport options\n   */\n  constructor(options = { apiBase: '/' }) {\n    /**\n     * Transport options\n     * @member Client#options\n     */\n    this.options = options;\n  }\n\n  /**\n   * Preform a GET request\n   *\n   * @method get\n   * @see {@link uri} for possible endpoints.\n   * @params {string} endpoint - api endpoint\n   * @params {object} [args={}] - arguments\n   * @returns {Promise<Object, Error>} Response body\n   * */\n  get(endpoint, args = {}) {\n    return this.request('GET', endpoint, args);\n  }\n\n  /**\n   * Preform a PUT update request\n   *\n   * @method put\n   * @see {@link uri} for possible endpoints.\n   * @params {string} endpoint - api endpoint\n   * @params {object} [args={}] - arguments\n   * @returns {Promise<Object, Error>} Response body\n   * */\n  put(endpoint, args = {}) {\n    return this.request('PUT', endpoint, args);\n  }\n\n  /**\n   * Preform a POST request\n   *\n   * @method post\n   * @see {@link uri} for possible endpoints.\n   * @params {string} endpoint - api endpoint\n   * @params {object} [args={}] - arguments\n   * @returns {Promise<Object, Error>} Response body\n   * */\n  post(endpoint, args = {}) {\n    return this.request('POST', endpoint, args);\n  }\n\n  /**\n   * Preform a DELETE request\n   *\n   * @method delete\n   * @see {@link uri} for possible endpoints.\n   * @params {string} endpoint - api endpoint\n   * @params {object} [args={}] - arguments\n   * @returns {Promise<Object, Error>} Response body\n   * */\n  delete(endpoint, args = {}) {\n    return this.request('DELETE', endpoint, args);\n  }\n\n  requestPromise(options) {\n    return new Promise((resolve, reject) => {\n      request(options, (err, response, body) => {\n        if (err) {\n          reject(new RequestError(err));\n        } else if (clientError(response)) {\n          const msg = (body.response && body.response.error)\n            ? body.response.error : response.statusMessage;\n\n          reject(new StatusCodeError(response.statusCode, msg));\n        } else if (responseContainsError(body)) {\n          const msg = (body.response && body.response.error)\n            ? body.response.error : response.statusMessage;\n\n          reject(new RequestError(Error(msg)));\n        } else if (response.statusCode >= 500) {\n          reject(new StatusCodeError(response.statusCode,\n            response.statusMessage));\n        } else {\n          resolve([body, response]);\n        }\n      });\n    });\n  }\n\n  /**\n   * Preform a the actual request\n   *\n   * @method request\n   * @private\n   * @see {@link uri} for possible endpoints.\n   * @params {string} method - Request method\n   * @params {string} endpoint - api endpoint\n   * @params {object} [args={}] - arguments\n   * @returns {Promise<Object, Error>} Response body\n   * */\n  request(method, endpoint, args) {\n    const payload = {\n      method,\n      uri: this.options.apiBase + endpoint,\n    };\n\n    if (this.options.proxy) {\n      payload.proxy = this.options.proxy;\n    }\n\n    if (method === 'GET') {\n      payload.json = true;\n      payload.qs = args;\n    } else {\n      payload.json = args;\n    }\n\n    if (this.options.token && this.options.token.value) {\n      payload.headers = {\n        Authorization: this.options.token.value,\n      };\n    }\n\n    return this.requestPromise(payload)\n      .then(([body]) => body.response);\n  }\n}\n\nexport default Transport;\n","/**\n * Created by Luke on 01/05/15.\n */\nimport { RateLimiter } from 'limiter';\n\nimport endpoints from './Endpoints';\nimport Transport from './Transport';\n\n/** @constant {number} */\nconst MAX_AUTH_PERIOD = 300000;\n\n/** @constant {number} */\nconst MAX_READ_PERIOD = 60000;\n\n/** @constant {number} */\nconst MAX_WRITE_PERIOD = 60000;\n\n/** @constant {number} */\nconst MAX_READ_PER_PERIOD = 100;\n\n/** @constant {number} */\nconst MAX_WRITE_PER_PERIOD = 60;\n\n/** @constant {number} */\nconst MAX_AUTH_PER_PERIOD = 10;\n\n/** @constant {number} */\nconst TOKEN_LIFETIME = 60 * 60 * 1000;\n\n/** @private */\nlet credentials = {};\n\n/**\n * AppNexus Client API class.\n *\n * @class Client\n * @extends Transport\n */\nclass Client extends Transport {\n  /**\n   * Client constructor.\n   *\n   * @constructs Client\n   * @params {string} [apiBase=https://api.appnexus.com] - default api domain\n   * @params {string} [proxy=null] - proxy url\n   * @params {object} [limits={}] - rate limits\n   */\n  constructor(apiBase = 'https://api.appnexus.com',\n    proxy = null,\n    limits = {\n      write: MAX_WRITE_PER_PERIOD,\n      read: MAX_READ_PER_PERIOD,\n      auth: MAX_AUTH_PER_PERIOD,\n    }) {\n    super();\n    this.options = { apiBase, limits, proxy };\n\n    /* Set limiters */\n    this.writeLimiter = new RateLimiter(limits.write, MAX_WRITE_PERIOD);\n    this.readLimiter = new RateLimiter(limits.read, MAX_READ_PERIOD);\n    this.authLimiter = new RateLimiter(limits.auth, MAX_AUTH_PERIOD);\n  }\n\n  /**\n   * Authorize client function\n   *\n   * @method authorize\n   * @params {string} username - Username\n   * @params {string} password - Password\n   * @returns {Promise<String, Error>} AppNexus Access Token\n   */\n  async authorize(username, password) {\n    if (!username || !password) {\n      throw new Error('Authorization credentials are missing!');\n    }\n\n    credentials = { username, password };\n\n    if (this.options.token) {\n      delete this.options.token;\n    }\n\n    const response = await this.post(endpoints.AUTHENTICATION_SERVICE, { auth: credentials });\n    this.options.token = { value: response.token, _ts: +new Date() };\n    return response.token;\n  }\n\n  /**\n   * Refresh token\n   **\n   * @method refreshToken\n   * @returns {Promise<String, Error>} AppNexus Access Token\n   */\n  refreshToken() {\n    if (!credentials.username || !credentials.password) {\n      throw new Error('Authorization credentials are missing!');\n    }\n\n    return this.authorize(credentials.username, credentials.password);\n  }\n\n  /**\n   * Checks if request token is not expired\n   **\n   * @isExpired rateLimiter\n   * @returns {boolean} token expired\n   */\n  isExpired(ts = 0) {\n    const timestamp = this.options.token\n                    && this.options.token._ts\n      ? this.options.token._ts : ts;\n\n    return timestamp + TOKEN_LIFETIME <= +new Date();\n  }\n\n  /**\n   * Rate limit a request according to specs\n   **\n   * @method rateLimiter\n   * @see {@link uri} for possible endpoints.\n   * @params {string} method - Request method\n   * @params {string} endpoint - api endpoint\n   * @returns {Promise<Number, Error>} Number of request left\n   */\n  rateLimiter(method, endpoint) {\n    return new Promise((resolve, reject) => {\n      let limiter = null;\n\n      if (endpoint === endpoints.AUTHENTICATION_SERVICE) {\n        limiter = this.authLimiter;\n      } else if (method === 'POST' || method === 'PUT' || method === 'DELETE') {\n        limiter = this.writeLimiter;\n      } else if (method === 'GET') {\n        limiter = this.readLimiter;\n      } else {\n        return resolve();\n      }\n\n      limiter.removeTokens(1, (err, remainingRequests) => {\n        if (err) {\n          return reject(err);\n        }\n\n        resolve(remainingRequests);\n      });\n    });\n  }\n\n  /**\n   * Request client function\n   *\n   * Adds rate limit and ensures refresh token is valid\n   *\n   * @method request\n   * @extends Transport.request\n   * @private\n   * @see {@link uri} for possible endpoints.\n   * @params {string} method - Request method\n   * @params {string} endpoint - api endpoint\n   * @params {object} [args={}] - arguments\n   * @returns {Promise<Object, Error>} Response body\n   */\n  async request(...args) {\n    const [method, endpoint] = args;\n\n    await this.rateLimiter(method, endpoint);\n    // check if token is still valid\n    if (endpoint !== endpoints.AUTHENTICATION_SERVICE\n      && this.isExpired()) {\n      return this.refreshToken()\n        .then(super.request(...args));\n    }\n    return super.request(...args);\n  }\n}\n\nexport default Client;\n","/**\n * Created by Luke on 01/05/15.\n */\n\nimport Client from './Client';\nimport Transport from './Transport';\nimport endpoints from './Endpoints';\n\nexport { Client, Transport, endpoints };\n"],"names":["RateLimiter"],"mappings":"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"}
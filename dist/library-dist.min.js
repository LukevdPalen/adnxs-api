var _get=function E(e,t,r){var R=Object.getOwnPropertyDescriptor(e,t);if(void 0===R){var _=Object.getPrototypeOf(e);return null===_?void 0:E(_,t,r)}if("value"in R)return R.value;var I=R.get;return void 0===I?void 0:I.call(r)},_inherits=function(E,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);E.prototype=Object.create(e&&e.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),e&&(E.__proto__=e)},_classCallCheck=function(E,e){if(!(E instanceof e))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function E(E,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(E,r.key,r)}}return function(e,t,r){return t&&E(e.prototype,t),r&&E(e,r),e}}();!function(E,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("limiter"),require("request-promise")):"function"==typeof define&&define.amd?define(["exports","limiter","request-promise"],e):e(E.AddNXS={},E._limiter,E.request_promise)}(this,function(E,e,t){"use strict";function r(E){return"OK"!==E.response.status?!0:!1}function R(E){var e=new Error(E&&E.response&&E.response.error);return e.error_id=E&&E.response&&E.response.error_id,e}function _(E,e,t){var r=R(E);return r}var I={ACCOUNT_RECOVERY_SERVICE:"/account-recovery",AD_PROFILE_SERVICE:"/ad-profile",AD_QUALITY_RULE_SERVICE:"/ad-quality-rule",AD_SERVER_SERVICE:"/ad-server",ADVERTISER_SERVICE:"/advertiser",APP_INSTALLATION_SERVICE:"/app-installation",AUTHENTICATION_SERVICE:"/auth",BATCH_SEGMENT_SERVICE:"/batch-segment",BRAND_COMPANY_SERVICE:"/brand-company",BRAND_SERVICE:"/brand",BROKER_SERVICE:"/broker",BROWSER_SERVICE:"/browser",CAMPAIGN_SERVICE:"/campaign",CARRIER_SERVICE:"/carrier",CATEGORY_SERVICE:"/category",CITY_SERVICE:"/city",CLICK_TRACKER_SERVICE:"/clicktracker",CONTENT_CATEGORY_SERVICE:"/content-category",COUNTRY_SERVICE:"/country",CREATIVE_CUSTOM_REQUEST_TEMPLATE_SERVICE:"/creative-custom-request-template",CREATIVE_CUSTOM_REQUEST_TEMPLATE_TYPE_SERVICE:"/creative-custom-request-template-type",CREATIVE_FOLDER_SERVICE:"/creative-folder",CREATIVE_FORMAT_SERVICE:"/creative-format",CREATIVE_MACRO_CHECK_SERVICE:"/creative-macro-check",CREATIVE_SEARCH_SERVICE:"/creative-search",CREATIVE_SERVICE:"/creative",CREATIVE_TEMPLATE_SERVICE:"/template",CURRENCY_SERVICE:"/currency",DEAL_BUYER_ACCESS_SERVICE:"/package-buyer-access",DEAL_FROM_PACKAGE_SERVICE:"/deal-from-package",DEAL_SERVICE:"/deal",DEMOGRAPHIC_AREA_SERVICE:"/dma",DEVELOPER_SERVICE:"/developer",DEVICE_MAKE_SERVICE:"/device-make",DEVICE_MODEL_SERVICE:"/device-model",DOMAIN_AUDIT_STATUS_SERVICE:"/url-audit-search",DOMAIN_LIST_SERVICE:"/domain-list",EXTERNAL_INVENTORY_CODE_SERVICE:"/external-inv-code",EXTRACT_CLICKTAGS_SERVICE:"/extract-click-tags",FEED_STATUS_SERVICE:"/feed-status",IMPRESSION_TRACKER_SERVICE:"/imptracker",INSERTION_ORDER_SERVICE:"/insertion-order",INVENTORY_ATTRIBUTE_SERVICE:"/inventory-attribute",INVENTORY_GROUP_SERVICE:"/inventory-group",INVENTORY_RESOLD_SERVICE:"/inventory-resold",INVENTORY_SOURCE_SERVICE:"/inventory-source",IP_RANGE_LIST_SERVICE:"/ip-range-list",LABEL_SERVICE:"/label",LANGUAGE_SERVICE:"/language",LINE_ITEM_SERVICE:"/line-item",LOG_LEVEL_DATA_SERVICE:"/siphon",LOOKUP_SERVICE:"/lookup",MANUAL_OFFER_RANKING_SERVICE:"/manual-offer-ranking",MEDIA_SUBTYPE_SERVICE:"/media-subtype",MEDIA_TYPE_SERVICE:"/media-type",MEMBER_PROFILE_SERVICE:"/member-profile",MEMBER_SERVICE:"/member",MOBILE_APP_INSTANCE_LIST_SERVICE:"/mobile-app-instance-list",MOBILE_APP_INSTANCE_SERVICE:"/mobile-app-instance",MOBILE_APP_SERVICE:"/mobile-app",MOBILE_APP_STORE_SERVICE:"/mobile-app-store",OBJECT_LIMIT_SERVICE:"/object-limit",OPERATING_SYSTEM_EXTENDED_SERVICE:"/operating-system-extended",OPERATING_SYSTEM_FAMILY_SERVICE:"/operating-system-family",OPERATING_SYSTEM_SERVICE:"/operating-system",OPTIMIZATION_ZONE_SERVICE:"/optimization-zone",PACKAGE_BUYER_ACCESS_SERVICE:"/package-buyer-access",PACKAGE_SERVICE:"/package",PAYMENT_RULE_SERVICE:"/payment-rule",PIXEL_SERVICE:"/pixel",PIXEL_TEMPLATE_SERVICE:"/pixel-template",PLACEMENT_SERVICE:"/placement",PLATFORM_MEMBER_SERVICE:"/platform-member",PLUGIN_INSTANCE_SERVICE:"/plugin-instance",PLUGIN_SERVICE:"/plugin",PROFILE_SERVICE:"/profile",PROFILE_SUMMARY_SERVICE:"/profile-summary",PUBLISHER_SERVICE:"/publisher",REGION_SERVICE:"/region",REPORT_SERVICE:"/report",REPORT_STATUS_SERVICE:"/report-status",SAVED_REPORT_SERVICE:"/saved-report",SEARCH_SERVICE:"/search",SEGMENT_SERVICE:"/segment",SIPHON_CONFIG_SERVICE:"/siphon-config",SITE_SERVICE:"/site",TAG_PARSER_SERVICE:"/tag-parser-job",TECHNICAL_ATTRIBUTE_SERVICE:"/technical-attribute",THIRD_PARTY_PAGE_ACCESS_SERVICE:"/thirdparty-pageaccess",THIRD_PARTY_PIXEL_SERVICE:"/thirdparty-pixel",TOWN_SERVICE:"/town",USER_GROUP_PATTERN_SERVICE:"/usergroup-pattern",USER_SERVICE:"/user",USER_VERIFICATION_SERVICE:"/user-verification",VISIBILITY_PROFILE_SERVICE:"/visibility-profile"},i=I,C=function(){function E(){var e=void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,E),this.options=e,this.options.apiBase=this.options.apiBase||"/"}return _createClass(E,[{key:"get",value:function(E){var e=void 0===arguments[1]?{}:arguments[1];return this.request("GET",E,e)}},{key:"put",value:function(E){var e=void 0===arguments[1]?{}:arguments[1];return this.request("PUT",E,e)}},{key:"post",value:function(E){var e=void 0===arguments[1]?{}:arguments[1];return this.request("POST",E,e)}},{key:"request",value:function(E,e,t){var R={uri:this.options.apiBase+e,json:t,method:E};return this.options.token&&(R.headers={Authorization:this.options.token}),request_promise__default(R).then(function(E){if(r(E))throw _(E);return E.response})}}]),E}(),a=C,n=3e5,S=6e4,o=6e4,s=100,V=60,T=10,A=36e5,u={},p=function(E){function t(){var E=void 0===arguments[0]?"http://api.appnexus.com":arguments[0],r=void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.options={apiBase:E,limits:r},this.writeLimiter=new e.RateLimiter(r.write||V,o),this.readLimiter=new e.RateLimiter(r.read||s,S),this.authLimiter=new e.RateLimiter(r.auth||T,n)}return _inherits(t,E),_createClass(t,[{key:"authorize",value:function(E,e){var t=this;if(!E||!e)throw Error("Authorization credentials are missing!");u={username:E,password:e};var r={auth:u};return this.options.token&&delete this.options.token,this.post(i.AUTHENTICATION_SERVICE,r).then(function(E){return console.log(E),t.options.token={value:E.token,_ts:+new Date},E.token})}},{key:"refreshToken",value:function(){if(!u.username||!u.password)throw Error("Authorization credentials are missing!");return this.authorize(u.username,u.password)}},{key:"isExpired",value:function(){return!!(this.options.token&&this.options.token._ts+A>=+new Date)}},{key:"rateLimiter",value:function(E,e){var t=this;return new Promise(function(r,R){var _=null;if(e===i.AUTHENTICATION_SERVICE)_=t.authLimiter;else if("POST"===E||"PUT"===E||"DELETE"===E)_=t.writeLimiter;else{if("GET"!==E)return r();_=t.readLimiter}_.removeTokens(1,function(E,e){return E?R(E):void r(e)})})}},{key:"request",value:function(){for(var E=this,e=arguments.length,r=Array(e),R=0;e>R;R++)r[R]=arguments[R];var _=this,I=r[0],C=r[1];return this.rateLimiter(I,C).then(function(){return C!==i.AUTHENTICATION_SERVICE&&E.isExpired()?E.refreshToken().then(_get(Object.getPrototypeOf(t.prototype),"request",_).apply(_,r)):_get(Object.getPrototypeOf(t.prototype),"request",_).apply(_,r)})}}]),t}(a),c={ACCOUNT_RECOVERY_SERVICE:"/account-recovery",AD_PROFILE_SERVICE:"/ad-profile",AD_QUALITY_RULE_SERVICE:"/ad-quality-rule",AD_SERVER_SERVICE:"/ad-server",ADVERTISER_SERVICE:"/advertiser",APP_INSTALLATION_SERVICE:"/app-installation",AUTHENTICATION_SERVICE:"/auth",BATCH_SEGMENT_SERVICE:"/batch-segment",BRAND_COMPANY_SERVICE:"/brand-company",BRAND_SERVICE:"/brand",BROKER_SERVICE:"/broker",BROWSER_SERVICE:"/browser",CAMPAIGN_SERVICE:"/campaign",CARRIER_SERVICE:"/carrier",CATEGORY_SERVICE:"/category",CITY_SERVICE:"/city",CLICK_TRACKER_SERVICE:"/clicktracker",CONTENT_CATEGORY_SERVICE:"/content-category",COUNTRY_SERVICE:"/country",CREATIVE_CUSTOM_REQUEST_TEMPLATE_SERVICE:"/creative-custom-request-template",CREATIVE_CUSTOM_REQUEST_TEMPLATE_TYPE_SERVICE:"/creative-custom-request-template-type",CREATIVE_FOLDER_SERVICE:"/creative-folder",CREATIVE_FORMAT_SERVICE:"/creative-format",CREATIVE_MACRO_CHECK_SERVICE:"/creative-macro-check",CREATIVE_SEARCH_SERVICE:"/creative-search",CREATIVE_SERVICE:"/creative",CREATIVE_TEMPLATE_SERVICE:"/template",CURRENCY_SERVICE:"/currency",DEAL_BUYER_ACCESS_SERVICE:"/package-buyer-access",DEAL_FROM_PACKAGE_SERVICE:"/deal-from-package",DEAL_SERVICE:"/deal",DEMOGRAPHIC_AREA_SERVICE:"/dma",DEVELOPER_SERVICE:"/developer",DEVICE_MAKE_SERVICE:"/device-make",DEVICE_MODEL_SERVICE:"/device-model",DOMAIN_AUDIT_STATUS_SERVICE:"/url-audit-search",DOMAIN_LIST_SERVICE:"/domain-list",EXTERNAL_INVENTORY_CODE_SERVICE:"/external-inv-code",EXTRACT_CLICKTAGS_SERVICE:"/extract-click-tags",FEED_STATUS_SERVICE:"/feed-status",IMPRESSION_TRACKER_SERVICE:"/imptracker",INSERTION_ORDER_SERVICE:"/insertion-order",INVENTORY_ATTRIBUTE_SERVICE:"/inventory-attribute",INVENTORY_GROUP_SERVICE:"/inventory-group",INVENTORY_RESOLD_SERVICE:"/inventory-resold",INVENTORY_SOURCE_SERVICE:"/inventory-source",IP_RANGE_LIST_SERVICE:"/ip-range-list",LABEL_SERVICE:"/label",LANGUAGE_SERVICE:"/language",LINE_ITEM_SERVICE:"/line-item",LOG_LEVEL_DATA_SERVICE:"/siphon",LOOKUP_SERVICE:"/lookup",MANUAL_OFFER_RANKING_SERVICE:"/manual-offer-ranking",MEDIA_SUBTYPE_SERVICE:"/media-subtype",MEDIA_TYPE_SERVICE:"/media-type",MEMBER_PROFILE_SERVICE:"/member-profile",MEMBER_SERVICE:"/member",MOBILE_APP_INSTANCE_LIST_SERVICE:"/mobile-app-instance-list",MOBILE_APP_INSTANCE_SERVICE:"/mobile-app-instance",MOBILE_APP_SERVICE:"/mobile-app",MOBILE_APP_STORE_SERVICE:"/mobile-app-store",OBJECT_LIMIT_SERVICE:"/object-limit",OPERATING_SYSTEM_EXTENDED_SERVICE:"/operating-system-extended",OPERATING_SYSTEM_FAMILY_SERVICE:"/operating-system-family",OPERATING_SYSTEM_SERVICE:"/operating-system",OPTIMIZATION_ZONE_SERVICE:"/optimization-zone",PACKAGE_BUYER_ACCESS_SERVICE:"/package-buyer-access",PACKAGE_SERVICE:"/package",PAYMENT_RULE_SERVICE:"/payment-rule",PIXEL_SERVICE:"/pixel",PIXEL_TEMPLATE_SERVICE:"/pixel-template",PLACEMENT_SERVICE:"/placement",PLATFORM_MEMBER_SERVICE:"/platform-member",PLUGIN_INSTANCE_SERVICE:"/plugin-instance",PLUGIN_SERVICE:"/plugin",PROFILE_SERVICE:"/profile",PROFILE_SUMMARY_SERVICE:"/profile-summary",PUBLISHER_SERVICE:"/publisher",REGION_SERVICE:"/region",REPORT_SERVICE:"/report",REPORT_STATUS_SERVICE:"/report-status",SAVED_REPORT_SERVICE:"/saved-report",SEARCH_SERVICE:"/search",SEGMENT_SERVICE:"/segment",SIPHON_CONFIG_SERVICE:"/siphon-config",SITE_SERVICE:"/site",TAG_PARSER_SERVICE:"/tag-parser-job",TECHNICAL_ATTRIBUTE_SERVICE:"/technical-attribute",THIRD_PARTY_PAGE_ACCESS_SERVICE:"/thirdparty-pageaccess",THIRD_PARTY_PIXEL_SERVICE:"/thirdparty-pixel",TOWN_SERVICE:"/town",USER_GROUP_PATTERN_SERVICE:"/usergroup-pattern",USER_SERVICE:"/user",USER_VERIFICATION_SERVICE:"/user-verification",VISIBILITY_PROFILE_SERVICE:"/visibility-profile"},l=c,O={Client:p,Transport:C,endPoints:l},m=O;E["default"]=m});
//# sourceMappingURL=library-dist.min.js.map